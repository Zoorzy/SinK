<!DOCTYPE html>
<html lang="it-IT">

<head>
  <%- include("../partials/header.ejs") %>
</head>

<body>
  <div class="container-fluid position-relative d-flex p-0">
    <!-- Spinner Start -->
    <%- include("../partials/spinner.ejs") %>
      <!-- Spinner End -->


      <!-- Sidebar Start -->
      <%- include("../partials/sidebar.ejs") %>
        <!-- Sidebar End -->


        <!-- Content Start -->
        <div class="content">
          <!-- Navbar Start -->
          <%- include("../partials/navbar.ejs") %>
            <!-- Navbar End -->


            <form>
              <!-- Form Start -->
              <div class="container-fluid pt-4 px-4">
                <div class="row g-4">

                  <h1 class="mb-4">Generate Report</h1>

                  <div class="col-sm-12 col-xl-6">
                    <div class="bg-secondary rounded h-100 p-4">
                      <div class="mb-3">
                        <label for="url" class="form-label">
                          <h2>URL</h2>
                        </label>
                        <input type="text" class="form-control" name="url" id="url" aria-describedby="url"
                          value="<%-url%>" readonly="readonly">
                        <div id="emailHelp" class="form-text">This is the target we are currently scanning
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-sm-12 col-xl-6">
                    <div class="bg-secondary rounded h-100 p-4">
                      <h2 class="mb-4">HTML</h2>
                      <textarea name="html" id="txthtml" style="width: 100%" rows="10"></textarea>
                      <button type="button" class="btn btn-outline-info m-2" id="copyBtn" disabled><i
                          class="fa fa-copy"></i> Copy</button>
                      <button type="button" class="btn btn-outline-info m-2" id="downloadBtn" disabled><i
                          class="fa fa-download"></i> Download</button>
                      <button type="button" class="btn btn-outline-info m-2" id="viewBtn" disabled><i
                          class="fa fa-window-restore"></i> Open in new tab</button>
                      <script>
                        //copy button
                        document.getElementById("copyBtn").addEventListener('click', () => {
                          document.getElementById("txthtml").select()
                          document.execCommand('copy')
                        })
                        //download button
                        //open in new tab button
                      </script>

                      <!--<div class="row mb-3">
                        <label for="inputEmail3" class="col-sm-2 col-form-label">Email</label>
                        <div class="col-sm-10">
                          <input type="email" class="form-control" id="inputEmail3">
                        </div>
                      </div>
                      <div class="row mb-3">
                        <label for="inputPassword3" class="col-sm-2 col-form-label">Password</label>
                        <div class="col-sm-10">
                          <input type="password" class="form-control" id="inputPassword3">
                        </div>
                      </div>
                      <fieldset class="row mb-3">
                        <legend class="col-form-label col-sm-2 pt-0">Radios</legend>
                        <div class="col-sm-10">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="gridRadios" id="gridRadios1"
                              value="option1" checked>
                            <label class="form-check-label" for="gridRadios1">
                              First radio
                            </label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="gridRadios" id="gridRadios2"
                              value="option2">
                            <label class="form-check-label" for="gridRadios2">
                              Second radio
                            </label>
                          </div>
                        </div>
                      </fieldset>
                      <div class="row mb-3">
                        <legend class="col-form-label col-sm-2 pt-0">Checkbox</legend>
                        <div class="col-sm-10">
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="gridCheck1">
                            <label class="form-check-label" for="gridCheck1">
                              Check me out
                            </label>
                          </div>
                        </div>
                      </div>
                      <button type="submit" class="btn btn-primary">Sign in</button>-->

                    </div>
                  </div>

                  <!-- Position Start -->

                  <div class="col-sm-12 col-xl-6">
                    <div class="bg-secondary rounded h-100 p-4">

                      <h1 class="mb-4">IP-API</h1>
                      <!-- Description List Start -->
                      <dl class="row mb-0">
                        <dt class="col-sm-3">Query</dt>
                        <dd class="col-sm-9" id="apiQuery"></dd>

                        <dt class="col-sm-3">Status</dt>
                        <dd class="col-sm-9" id="apiStatus"></dd>

                        <dt class="col-sm-3">Country (CountryCode)</dt>
                        <dd class="col-sm-9">
                          <dl class="row">
                            <dt class="col-sm-4" id="apiCountry"></dt>
                            <dd class="col-sm-8" id="apiCountryCode"></dd>
                          </dl>
                        </dd>

                        <dt class="col-sm-3">Region</dt>
                        <dd class="col-sm-9" id="apiRegion"></dd>

                        <dt class="col-sm-3">Region Name</dt>
                        <dd class="col-sm-9" id="apiRegionName"></dd>

                        <dt class="col-sm-3">City</dt>
                        <dd class="col-sm-9" id="apiCity"></dd>

                        <dt class="col-sm-3">Zip</dt>
                        <dd class="col-sm-9" id="apiZip"></dd>

                        <dt class="col-sm-3">Lat</dt>
                        <dd class="col-sm-9" id="apiLat"></dd>

                        <dt class="col-sm-3">Lon</dt>
                        <dd class="col-sm-9" id="apiLon"></dd>

                        <dt class="col-sm-3">Timezone</dt>
                        <dd class="col-sm-9" id="apiTimezone"></dd>

                        <dt class="col-sm-3">ISP</dt>
                        <dd class="col-sm-9" id="apiIsp"></dd>

                        <dt class="col-sm-3">Org</dt>
                        <dd class="col-sm-9" id="apiOrg"></dd>

                        <dt class="col-sm-3">As</dt>
                        <dd class="col-sm-9" id="apiAs"></dd>
                      </dl>
                      <!-- Description List End -->

                    </div>
                  </div>
                  <div class="col-sm-12 col-xl-6">
                    <div class="bg-secondary rounded h-100 p-4">
                      <iframe src="" class="position-relative rounded w-100 h-100" id="map" frameborder="0"
                        allowfullscreen="" aria-hidden="false" tabindex="0"
                        style="filter: grayscale(100%) invert(92%) contrast(83%); border: 0; min-height: 400px;"></iframe>
                    </div>
                  </div>
                  <script>
                    //ip-api
                    let url = new URL(document.getElementById('url').value);
                    let map = document.getElementById('map')
                    fetch('http://ip-api.com/json/' + url.host)
                      .then((response) => response.json())
                      .then((data) => {
                        map.src = 'https://embed.waze.com/iframe?zoom=12&lat=' + data.lat + '&lon=' + data.lon
                        document.getElementById('apiQuery').textContent = data.query
                        document.getElementById('apiStatus').textContent = data.status
                        document.getElementById('apiCountry').textContent = data.country
                        document.getElementById('apiCountryCode').textContent = '(' + data.countryCode + ')'
                        document.getElementById('apiRegion').textContent = data.region
                        document.getElementById('apiRegionName').textContent = data.regionName
                        document.getElementById('apiCity').textContent = data.city
                        document.getElementById('apiZip').textContent = data.zip
                        document.getElementById('apiLat').textContent = data.lat
                        document.getElementById('apiLon').textContent = data.lon
                        document.getElementById('apiTimezone').textContent = data.timezone
                        document.getElementById('apiIsp').textContent = data.isp
                        document.getElementById('apiOrg').textContent = data.org
                        document.getElementById('apiAs').textContent = data.as
                      });
                  </script>
                  <!-- Position End -->

                  <div class="col-sm-12 col-xl-6">
                    <div class="bg-secondary rounded h-100 p-4">
                      <h1>What has been analyzed</h1>
                      <dl class="row mb-0">
                        <dt class="col-sm-3">Pattern-Sources</dt>
                        <dd class="col-sm-9">
                          <dl>
                            <dd>document.location.href</dd>
                            <dd>document.location</dd>
                            <dd>window.location.href</dd>
                            <dd>window.location</dd>
                          </dl>
                        </dd>
                        <dt class="col-sm-3">Pattern-Sinks</dt>
                        <dd class="col-sm-9">
                          <dl>
                            <dd>$X.insertAdjacentHTML(...)</dd>
                            <dd>$X.innerHTML(...)</dd>
                            <dd>$X.innerHTML = ...</dd>
                          </dl>
                        </dd>
                      </dl>
                    </div>
                  </div>
                  <div class="col-sm-12 col-xl-6">
                    <div class="bg-secondary rounded h-100 p-4">
                      <h1>What has been found</h1>
                      <dl class="row mb-0">
                        <dt class="col-sm-3">Pattern-Sources</dt>
                        <dd class="col-sm-9">
                          <dl>
                            <dd>document.location.href</dd>
                            <dd>document.location</dd>
                            <dd>window.location.href</dd>
                            <dd>window.location</dd>
                          </dl>
                        </dd>
                        <dt class="col-sm-3">Pattern-Sinks</dt>
                        <dd class="col-sm-9">
                          <dl>
                            <dd>$X.insertAdjacentHTML(...)</dd>
                            <dd>$X.innerHTML(...)</dd>
                            <dd>$X.innerHTML = ...</dd>
                          </dl>
                        </dd>
                      </dl>
                    </div>
                  </div>

                  <div class="col-sm-12 col-xl-6">
                    <div class="m-n2">
                      <button type="button" class="btn btn-outline-warning m-2">Generate Report</button>
                    </div>
                  </div>


                </div>
              </div>
              <!-- Form End -->

              <script src="../../public/js/newrepWorkerHandler.js"></script>

            </form>

            <!-- Footer Start -->
            <%- include("../partials/footer.ejs") %>
              <!-- Footer End -->
        </div>
        <!-- Content End -->


        <!-- Back to Top -->
        <%- include("../partials/arrowup.ejs") %>
  </div>

  <!-- JavaScript Libraries -->
  <%- include("../partials/jslib.ejs") %>
    <!-- Template Javascript -->
    <%- include("../partials/template.ejs") %>
</body>

</html>