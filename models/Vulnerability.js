const mongoose = require('mongoose');

const Vulnerability = mongoose.Schema({
  // descrizione facoltativa che descriva la vulnerabilit√†
  description: {
    type: String
  },
  // richiesta fatta per ottenere la risorsa
  req: {
    // data
    date: {
      type: Date,
      default: Date.now,
      required: true
    },
    // verione del protocollo HTTP(S)
    version: {
      type: String,
      required: true
    },
    // metodo {GET | POST | ..}
    method: {
      type: String,
      enum : ['GET', 'HEAD', 'POST', 'PUT', 'DELETE', 'CONNECT', 'OPTIONS', 'TRACE', 'PATCH'],
      required: true,
    },
    pathname: {
      type: String,
      required: true
    },
    params: [{ key: { type: String }, value: { type: String } }],
  },
  source:{
    line: {
      type: String
    },
    tag: {
      type: String
    },
    input:{
      type: String,
      required: true
    }
  },
  sink:{
    line: {
      type: String
    },
    tag: {
      type: String
    },
    output: {
      type: String,
      required: true
    }
  },
  vulnerability:{
    type: String,
    default: "DOM-XSS"
  },
});

module.exports = mongoose.model('Vulnerability', Vulnerability);